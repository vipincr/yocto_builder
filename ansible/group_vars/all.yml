---
# System Configuration
system_timezone: UTC
system_locale: en_US.UTF-8

# Application Configuration
app_name: yocto_builder
app_user: yocto
app_group: yocto
app_home: /opt/yocto_builder
app_repo: "{{ lookup('env', 'APP_REPO') | default('https://github.com/your-org/yocto_builder.git') }}"
app_branch: main

# Directory Configuration
builds_directory: /data/builds
logs_directory: /var/log/yocto_builder

# Node.js Configuration
nodejs_version: "22"
pm2_instances: 1

# PostgreSQL Configuration
postgresql_version: "16"
postgresql_db: yocto_builder
postgresql_user: yocto_admin
postgresql_password: "{{ vault_postgresql_password | default('changeme') }}"
postgresql_host: localhost
postgresql_port: 5432

# Docker Configuration
docker_version: "27.0"
docker_storage_driver: overlay2
docker_log_driver: json-file
docker_log_max_size: 100m
docker_log_max_file: 3

# Poky Docker Images
poky_images:
  - name: yocto-builder/poky-kirkstone
    version: "4.0"
    dockerfile: Dockerfile.kirkstone
  - name: yocto-builder/poky-scarthgap
    version: "5.0"
    dockerfile: Dockerfile.scarthgap

# Resource Limits (defaults, can be overridden)
build_container_cpus: "{{ lookup('env', 'BUILD_CONTAINER_CPUS') | default(6) | int }}"
build_container_memory: "{{ lookup('env', 'BUILD_CONTAINER_MEMORY') | default('28g') }}"
build_container_storage: "500g"

# Server Requirements
min_cpus: 8
min_memory_gb: 32
min_storage_gb: 1000

# Nginx Configuration
nginx_server_name: "{{ inventory_hostname }}"
nginx_ssl_enabled: true
nginx_ssl_certificate: /etc/letsencrypt/live/{{ nginx_server_name }}/fullchain.pem
nginx_ssl_certificate_key: /etc/letsencrypt/live/{{ nginx_server_name }}/privkey.pem

# OAuth Configuration (from vault, with defaults)
github_client_id: "{{ vault_github_client_id | default(lookup('env', 'GITHUB_CLIENT_ID') | default('')) }}"
github_client_secret: "{{ vault_github_client_secret | default(lookup('env', 'GITHUB_CLIENT_SECRET') | default('')) }}"
google_client_id: "{{ vault_google_client_id | default(lookup('env', 'GOOGLE_CLIENT_ID') | default('')) }}"
google_client_secret: "{{ vault_google_client_secret | default(lookup('env', 'GOOGLE_CLIENT_SECRET') | default('')) }}"
nextauth_secret: "{{ vault_nextauth_secret | default(lookup('env', 'NEXTAUTH_SECRET') | default('changeme-secret-key-change-in-production')) }}"

# NextAuth URL (default, should be overridden in playbooks)
nextauth_url: "{{ lookup('env', 'NEXTAUTH_URL') | default('http://localhost:3000') }}"

